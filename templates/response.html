<!DOCTYPE html>
<html>
<head>
    <title>Resultado Bancos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <style>
        .floating-alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10002;
            min-width: 300px;
            max-width: 440px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.22);
            animation: fadeInScale 0.25s ease-out;
            display: none;
        }

        .floating-alert .alert-header {
            background: linear-gradient(135deg, #2563eb 0%, #16a34a 100%);
            color: #ffffff;
            padding: 12px 16px;
            text-align: center;
            font-weight: 700;
        }

        .download-stack {
            max-width: 700px;
            margin: 0 auto 20px auto;
        }

        .download-card {
            border: 1px solid #dbe3f0;
            border-radius: 12px;
            padding: 14px;
            background: #ffffff;
            box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06);
        }

        @keyframes fadeInScale {
            from { opacity: 0; transform: translate(-50%, -46%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }
    </style>
</head>

<body>
    <header>
        <img src="{{ url_for('static', filename='images/logos.jpeg') }}" alt="Imagen" width="150" height="80">
    
       </header>
    <nav  class="bg-body-tertiary">
  
        <ul class="nav nav-pills justify-content-center mb-3 "  id="pills-tab" role="tablist">
            <li class="nav-item">
              <a class="nav-link " href="/">Home</a>
            </li>
            <li class="nav-item">
                            <a class="nav-link " href="/basedatos">Base de Datos</a>
            </li>
                        <li class="nav-item">
                                <a class="nav-link" href="/asiento">Asientos</a>
                        </li>
                        <li class="nav-item">
                                <a class="nav-link" href="/correos">Correos</a>
                        </li>
            <li class="nav-item">
                                <a class="nav-link active" href="/upload">Resultados</a>
              </li>
           
          </ul>
       </nav>
    <div class="floating-alert" id="floatingAlert">
        <div class="alert-header" id="floatingAlertText">✅ Proceso exitosamente.</div>
    </div>

    <div class="container text-center pb-4">
        <div class="row">
                   
    <div class="row download-stack g-3">
        <div class="col-12">
            <div class="download-card">
                <form action="/upload" method="POST" class="download-form" data-success-msg="✅ La descarga de movimientos fue exitosamente.">
                    <button type="submit" class="btn btn-success btn-lg w-100">Movimientos</button>
                </form>
            </div>
        </div>

        <div class="col-12">
            <div class="download-card">
                <form action="/download_recaudos" method="POST" class="download-form" data-success-msg="✅ La descarga de recaudos fue exitosamente.">
                    <button type="submit" class="btn btn-success btn-lg w-100">Recaudos</button>
                </form>
            </div>
        </div>
    </div>
            <div class="col">
                <div class="card">

                
                <h1>Estado de cuenta</h1>
                <label for="movimientos"></label>
                {% if data.movements.message   %}
                <span>{{data.movements.message   }}</span>
                <ul>
                    {% for item in data.movements.items %}
                      <li>{{ item["monto"] }}</li>
                    {% endfor %}
                  </ul>
                {% endif %}
            </div>
            </div>
        </div>

        <div class="row">
            <div class="col">

                <div class="card">
        <!-- Transferencias-->
        <h1>Resumen Transfers</h1>
        <label for="tranfers"></label>
        {% if data.transfers.message  %}
        <span class="error">Error {{data.transfers.message}}</span>
        
        <table>
            <thead>
                <tr>
                    <td>Fecha</td>
                    <td>Ordenante</td>
                    <td>Monto</td>
                </tr>
            </thead>
            <tbody>
            {% for item in data.transfers.items %}
            <tr>
                <td>{{ item["fecha"] }}</td>
                <td>{{ item["ordenante"] }}</td>
                <td>{{ item["monto"] }}</td>
            </tr>
              
            {% endfor %}
    
                
            </tbody>
        </table>
        
        
        {% endif %}        
    </div>
            </div>
        </div>


        <div class="row">
            <div class="col">

                <div class="card">
    <!--Providers-->
    <h1>Resumen Providers</h1>
    <label for="providers"></label>
    {% if data.providers.message  %}
    <span class="error">Error: {{data.providers.message}}</span>
    <table>
        <thead>
            <tr>
                <td>Fecha</td>
                <td>Ordenante</td>
                <td>Monto</td>
            </tr>
        </thead>
        <tbody>
        {% for item in data.providers.items %}
        <tr>
            <td>{{ item["fecha"] }}</td>
            <td>{{ item["ordenante"] }}</td>
            <td>{{ item["monto"] }}</td>
        </tr>
          
        {% endfor %}

            
        </tbody>
    </table>
    
    
    {% endif %}
</div>
            </div>
        </div>
    
    
        <div class="row">
            <div class="col">
                <div class="card">
    <!--Interbanks-->
    <h1>Resumen Interbancarios</h1>
    <label for="interbanks"></label>
    {% if data.interbanks.message  %}
    <span class="error">Error {{data.interbanks.message}}</span>
    
    <table>
        <thead>
            <tr>
                <td>Ordenante</td>
                <td>Monto</td>
                <td>Operacion</td>
            </tr>
        </thead>
        <tbody>
        {% for item in data.interbanks.items %}
        <tr>
            <td>{{ item["ordenante"] }}</td>
            <td>{{ item["monto"] }}</td>
            <td>{{ item["operacion"] }}</td>
        </tr>
          
        {% endfor %}

            
        </tbody>
    </table>

    
    
    {% endif %}            
</div>
            </div>
        </div>
       
        
 
    
    
    
        </div>


    <script>
    function showFloatingAlert(messageText) {
        const floatingAlert = document.getElementById('floatingAlert');
        const floatingAlertText = document.getElementById('floatingAlertText');
        if (!floatingAlert || !floatingAlertText) {
            return;
        }
        floatingAlertText.textContent = messageText;
        floatingAlert.style.display = 'block';
        setTimeout(function () {
            floatingAlert.style.display = 'none';
        }, 2200);
    }

    document.addEventListener('DOMContentLoaded', function () {
        showFloatingAlert('✅ Proceso exitosamente.');

        const forms = document.querySelectorAll('.download-form');
        forms.forEach(function (form) {
            form.addEventListener('submit', function () {
                const message = form.getAttribute('data-success-msg') || '✅ Descarga exitosa.';
                setTimeout(function () {
                    showFloatingAlert(message);
                }, 900);
            });
        });
    });
    </script>
    </body>
</html>